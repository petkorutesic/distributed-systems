<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Distributed systems</title>
    <meta name="author" content="Petko Rutešić">

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/distrib_beige.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		    <script src="lib/js/html5shiv.js"></script>
		<![endif]-->

	</head>
	<body>
		<div class="reveal">
			<div class="slides">

          <section class="grid3" >
					    <div class="container">
						      <div class="col">
							        <!-- Remove logo--full class to only show brand mark -->
							        <h2>Distributed systems</h2>

							        <h3>6. Communication</h3>
							    </div>
						  </div>
				  </section>

          <section data-transition="zoom">
              <h2> Importance of communication</h2>
              <ul style="font-size:80%">
                  <li> Interprocess communication is an esential part of all distributed systems</li>
                  <li>Exchange of information is based on low-level message passing</li>
                  <li>What kind of exchange is used for nondistributed platforms?</li>

                  <li>Communication must adhere to specific rules </li>
                  <li><mark><b>communication protocol</b></mark> - a set of rules according to which
                      communication is carried out</li>
                  <li> protocol is said to provide <b>communication services</b> </li>
                  <li>two types of communication services: </li>
                  <ul>
                      <li><b>connection-oriented</b> service - connection is
                          established bofore exchanging messages and specific parameters
                      of the used protocol , after exchange connection is terminated</li>
                      <li><b>connectionless</b> service - no setup in advance is needed</li>
                  </ul>
                  <li> protocols are easily explained if structured into layers </li>
              </ul>
          </section> 

          <section data-transition="linear">
              <h2>OSI reference model</h2>
                  <img src="myfiles/images/communication/osimodel2.svg" style="width:70%" />
                  <ul style="font-size:70%">
                      <li>ISO <b>OSI model</b> (Open Systems Interconnection Reference Model) </li>
                      <li>OSI <b>is only </b> refernce model and protocols developed
                          for OSI model have <b>never</b> been <b>widely used</b></li>
                      <li>however OSI model is useful for understanding computer networks</b></li>
                  </ul>
          </section>

          <section class="grid4" data-transition="linear">
              <div class="grid-wrapper">
						      <div class="header" >
                      <h3>OSI model</h3>
						      </div>
						      <div class="content">
                      <ul style="font-size: 60%">
                          <li><mark>application layer</mark> - e-mail protocols,
                              web access protocols, file transfer protocols   </li>
                          <li><mark>presentation layer</mark> - how data are represented
                          independently of the hosts on which applications are running</li>

                          <li><mark> session layer</mark> - support for sessions
                              between applications,synchronization facilities.
                              Inserting checkpoints, which is useful in case of crash   </li>
                          <li><mark> transport layer</mark> - protocols for directly
                              supporting applications (reliable communications, support of real
                              time streaming of data). Messages received from the upper
                              level are broken into smaller pieces suitable for the
                              transmission. How many packets are received, which have to be
                              retransmitted. <b>TCP</b> , <b>UDP</b>, ...
                          </li>

                          <li><mark> network layer</mark> - protocols for
                              <b>routing</b> a message through a computer network and
                              handling congestions, <b>IP</b> (Internet protocol) is the most
                              widely used network protocol</li>
                          <li><mark> data link layer</mark> - detecting and possibly
                              correcting transmission errors, computing <b>checksum</b>
                              and adding it to the frame </li>
                          <li><mark> physical layer</mark> - concerned about
                              transmitting 0s and 1s. How many bits per second can be sent. Meaning
                              and number of pins in network connectors, etc...</li>
                      </ul>
							    </div>
                  <div class="image">
                      <img src="myfiles/images/communication/osimodel1.svg" style="height:80%" />
				          </div>
              </div>
          </section>

          <section class="grid4" data-transition="linear">
              <div class="grid-wrapper">
						      <div class="header" >
                      <h3>Internet protocol suite</h3>
						      </div>
						      <div class="content">
                      <ul style="font-size: 70%">
                          <p>standard network model used for internet which has fewer
                              rigidly defined layers then OSI, easier fit for
                              real-world protocols</p>
                          <li><mark>application layer</mark> - layer in which high level
                              protocols operate such as e-mail protocols,
                              web access protocols, file transfer protocols (HTTP,
                              HTTPS, FTP, IMAP, POP, SSH, SMTP, Telnet,...)     </li>
                           <li><mark> transport layer</mark> -  provides a channel for the
                               communicaton needs of applications
                               (<b>TCP</b> , <b>UDP</b>, DCCP,  ...)
                          </li>

                          <li><mark> internet layer</mark> - provides uniform networking
                              interface for exchanging datagrams,  protocols for
                              <b>routing</b> a message through a computer network.
                              <b>IP</b> (Internet protocol) is the primary protocol in this 
                              scope (IPv4, IPv6, ICMP, ...)
                          </li>
                          <li><mark> link layer</mark> - includes protocols used to
                              describe local network topology and corresponds to
                              corresponds to the physical and data link layers of OSI model
                              MAC (Ethernet,  Wi-Fi,  DSL, ISDN,  FDDI),...
                          </li>
                      </ul>
							    </div>
                  <div class="image">
                      <img src="myfiles/images/communication/internet-protocol-suite.svg"
                           style="height:80%" />
				          </div>
              </div>
          </section>

          <section data-transition="linear">
              <h2>Middleware protocols</h2>
              <ul style="font-size:80%">
                  <li> Middleware should be mostly applications which are mostly in the
                      application layer</li>
                  <li> general purpose protocols offered for other applications </li>

                  <li> <b>DNS</b> Domain Name System - distributed service used
                  to lookup a network addresses associated with a name</li>
                      <ul>
                          <li>translates more readable domain names to IP addresses </li>

                          <li>for instance www.dhbw.de - > 141.31.235.50
                          you can try <b>ping dhbw.de</b></li>
                          <li>Example Google Public DNS offered to internet users
                              worldwide - IP addresses 8.8.8.8 and 8.8.4.4 are used
                              for IPv4 service, </li>
                      </ul>

                      <li> authentication and authorization protols could be
                          example of middleware protocols</li>
              </ul>
          </section>

          <section data-transition="linear">
              <h2>UDP (User Datagram Protocol)</h2>
              <ul>
                  <li>UDP is a simple transport protocol which extends host-to-host
                      delivery of packets
                      <ul>
                          <li><b>connectionless</b> protocol which belongs
                              to the transport layer</li>
                      </ul>
                  <li>abstract <b>port numbers</b> used to identify which processes communicate </li>
                  <ul>
                      <li> port numbers hold for a single host</li>
                      <li> that's why pair <b>port, host-ip</b> is used for demultiplexing in UDP</li>
                  </ul>
                  <li>unreliable, unordered delivery
              </ul>
          </section>
          <section class="grid4" data-transition="linear">
              <div class="grid-wrapper">
						      <div class="header" >
                      <h3>UDP protocol</h3>
						      </div>
						      <div class="content">
                      <ul style="font-size: 90%">
                          <p>UDP datagram (packet) consists of the following fields</p>
                          <li><mark>source port</mark> </li>
                          <li><mark> destination port</mark></li>
                          <li><mark>length</mark> of UDP segment including header</li>
                          <li><mark>checksum</mark> has a goal to detect "errors"
                              (flipped) bits in segments</li>
                          <li><mark> data </mark> application data (payload)</li>
                          </li>
                          <li> Why to use UDP protocol?</li>
                          <ul>
                              <li>no connection (no delay)</li>
                              <li>no connection state at sender (reciever)</li>
                              <li> small header size</li>
                              <li> no congestion control</li>
                          </ul>
                      </ul>
							    </div>
                  <div class="image">
                      <img src="myfiles/images/communication/udp-datagram.png"
                           style="height:100%" />
				          </div>
              </div>
          </section>


          <section data-transition="linear">
              <h2>TCP protocol</h2>
              <ul>
                  <li>TCP is a <b>connection-oriented</b> protocol which belongs
                      to the transport layer</li>
                      <ul>
                          <li>connection is maintained from the beginning till
                              the end of exchange</li>
                          <li>handshaking - exchange of control messages - 
                              sender, receiver state before data exchange </li>
                          <ul>
                              <li>to agree to establish connection </li>
                              <li>to agree on connection parameters </li>
                          </ul>
                          <li>full duplex data- bi directional data flow
                              in same connection </li>
                      </ul>
              </ul>
          </section>

          <section data-transition="linear">
              <h2>TCP dataram</h2>

                  <img src="myfiles/images/communication/tcp-datagram.png">
          </section>

          <section data-transition="zoom">
              <h2> TCP datagram structure</h2>
              <ul style="font-size:70%">
                          <p>TCP datagram (packet) consists of the following fields</p>
                          <li><mark>source port</mark> </li>
                          <li><mark> destination port</mark></li>
                          <li><mark> sequence number</mark></li>
                          <li><mark> acknowledgement number </mark></li>
                          <li><mark>flags</mark> indicating specific meaning of other fields </li>
                          <li><mark>receive window</mark> size of the window that receiver is willing to receive</li>
                          <li><mark>checksum</mark> has a goal to detect "errors"
                              (flipped) bits in segments</li>
                          <li><mark> options </mark> which are of variable size</li>
                          <li><mark> data </mark> application data (payload)</li>
                          </li>
                          <li> Why to use TCP protocol?</li>
                          <ul>
                              <li>reliable data transfer - not received packets
                                  are sent again</li>
                              <li>flow control</li>
                              <li>congestion control</li>
                          </ul>
                      </ul>
              </ul>
          </section> 
          <section class="grid4" data-transition="linear">
              <div class="grid-wrapper">
						      <div class="header" >
                      <h2> Sinergy of protocols (HTTP,FTP, TCP/IP, ...) </h2>
 						      </div>
						      <div class="content">
                      <ul style="font-size: 70%">
                          <p>These protocols work together to enable web transfers</p>
                          <li><b>HTTP</b> - Hyper Text Transfer Protocol is an appplication layer protocol</li> 
                          <li><b>TCP</b> - is a transport layer protocol</li> 
                          <li><b>IP</b> - is a network layer protocol </li> 

                          <li>an <a href="https://www.quora.com/How-is-TCP-IP-related-to-HTTP" target="_blank"> analogy</a> for better explanation </li>
                          <ul>
                              <li>  IP could be thought of as a high-way </li>  
                              <li>  TCP and UDP as different types of trucks</li>  
                              <li>  HTTP, SMTP, FTP and other application protocols as a load that trucks transport</li>  
                          </ul>
                      </ul>
							    </div>
                  <div class="image">
                      <img src="myfiles/images/communication/delivery-truck.png"
                           style="height:100%" />
				          </div>
              </div>
          </section>

          <section data-transition="zoom">
              <h2> Socket programming</h2>
              <ul style="font-size:80%">
                  <li>many distributed systems built on top of the simple
                      <b>message-oriented</b> model offered by the transport layer  </li>
                  <li><mark>socket</mark> is conceptually a communication end
                      point </li>
                  <ul>
                      <li> to which an application can write data to be sent over
                          an underlying network</li>
                      <li> from which incoming data can be read</li>
                  </ul>
                  <li>socket is a <b>specialized software</b> used for communication between
                       a client and a server</li>
                  <ul>
                      <li>one socket is located on the server side and one on the client side </li>
                  </ul>
                  <li> socket makes an abstraction over the actual port that is used
                      by the local operating system for a specific transport protocol</li>
              </ul>
          </section> 

          <section  data-transition="linear">
              <h3>Socket operations for TCP/IP</h3>
              <ul>
                  <table style="font-size:80%">
                      <tr>
                          <th>Operation</th>
                          <th>Description</th>
                      </tr>
                      <tr>
                          <td>socket</td>
                          <td>Create a new communication end point</td>
                      </tr>
                      <tr>
                          <td>bind</td>
                          <td>Attach a local address to a socket</td>
                      </tr>
                      <tr>
                          <td>listen</td>
                          <td>tell operating system what the maximum number of
                              pending connection requests should be</td>
                      </tr>
                      <tr>
                          <td>accept</td>
                          <td>Block caller until a connection request arrives</td>
                      </tr>
                      <tr>
                          <td>connect</td>
                          <td>Actively attempt to establish a connection</td>
                      </tr>
                      <tr>
                          <td>send</td>
                            <td>Send some data over the connection</td>
                      </tr>
                      <tr>
                          <td>receive</td>
                          <td>Receive some data over the connection</td>
                      </tr>
                      <tr>
                          <td>close</td>
                          <td>Release the connection</td>
                      </tr>

                  </table>
              </ul>
          </section>


          <section data-transition="linear">
              <h3>Connection-oriented communication using sockets</h3>
              <img src="myfiles/images/coordination/comm-sockets.png" style="width:100%" />
              <ul style="font-size:70%">
                  <li></li>

              </ul>
          </section> 

          <section data-transition="linear">
              <h3> <mark>Java Sockets</mark></h3>

              <ul style="font-size:75%">
                  <li><b>java.net</b> library offers classes for communication over Internet</li>
                  <li>classes <b>Socket</b>, and <b>ServerSocket</b> from java.net library use TCP to communicate
                      over network</li>
                  <li> classes <b>DatagramPacket</b>, <b>DatagramSocket</b>, and <b>MulticastSocket</b> are used with UDP</li> 
                  <li> usage of ServerSocket  on the server side</li> 
                  <pre><code class="hljs java" style="font-size:100%; word-wrap: break-word;">
        ServerSocket serverSocket = new ServerSocket(port);
                  </code></pre>
                  <li> ServerSocket throws IOException if I/O errors occur</li>
                  <li> ServerSocket instance calls accept method and blocks the call until
                      method receives request from the server when <b>Socket</b> instance
                      is created (which represents connection between client and server)</li>
                  <pre><code class="hljs java" style="font-size:100%; word-wrap: break-word;">
        Socket clientSocket = serverSocket.accept();
                  </code></pre>
              </ul>
          </section>

          <section data-transition="linear">
              <h3> Java TCP Sockets - server side</h3>

              <ul style="font-size:100%">
                  <li>we use <b>BufferedReader</b> to read text from  the client</li>
                  <pre><code class="hljs java" style="font-size:100%; word-wrap: break-word;">
        BufferedReader in = new BufferedReader(
            new InputStreamReader(clientServer.getInputStream()));
                  </code></pre>
                  <li> and <b>PrintWriter</b> instance to reply to the client</li>
                  <pre><code class="hljs java" style="font-size:100%; word-wrap: break-word;">
        PrintWriter pw  = new PrintWriter(
            clientServer.getOutputStream(), true);
                  </code></pre>
              </ul>
          </section>


          <section data-transition="linear">
              <h3> Java TCP Sockets - Simple Echo server </h3>

              <ul style="font-size:100%">
                  <li> the following lines will complete simple echo server</li>
                  <pre><code class="hljs java" style="font-size:100%; word-wrap: break-word;">
String inputLine;
while ((inputLine = br.readLine())!= null){
   System.out.println(inputLine);
   pw.println(inputLine);
}
                  </code></pre>
                  <li>this piece of code reads from client and sends the same text back to the client</li>
              </ul>
          </section>

          <section data-transition="linear">
              <h3> Java TCP Sockets - Simple Echo client </h3>

              <ul style="font-size:100%">
                  <li> first have to instantiate Socket to connect to the server and again we
                  use BufferedReader and PrintWriter to work with text</li>
                  <pre><code class="hljs java" style="font-size:100%; word-wrap: break-word;">
Socket clientSocket = new Socket( ipAddress, portNumber);
PrintWriter pw = new PrintWriter(
         clientSocket.getOutputStream(), true);
BufferedReader bf = new BufferedReader(
               new InputStreamReader( clientSocket.getInputStream()));

                  </code></pre>
              </ul>
          </section>

          <section data-transition="linear">
              <h3> Java TCP Sockets - Simple Echo client cont.</h3>

              <ul style="font-size:100%">
                  <li> the following code implements communication with the server</li>
                  <pre><code class="hljs java" style="font-size:100%; word-wrap: break-word;">

System.out.println("Connected to server!...");
Scanner scanner = new Scanner(System.in);
while(true){
    System.out.println("Enter text");
    String inputLine = scanner.nextLine();
    if(inputLine.equalsIgnoreCalse("quit")) break;
    pw.println(inputLine);
    System.out.println("Server responce is !");
    System.out.println(bf.readLine());
}
                  </code></pre>
              </ul>
          </section>
          <section data-transition="linear">
              <h3> Java TCP Sockets - server side</h3>

              <pre class="strech"><code class="hljs java" style="font-size:50%; word-wrap: break-word;">
public class HelloServer {
    public static void start(int port)){
        serverSocket = new ServerSocket(port);
        clientSocket = serverSocket.accept();
        PrintWriter out = new PrintWriter(clientSocket.getOutputStream(), true);
        BufferedReader in = new BufferedReader(
                   new InputStreamReader(clientSocket.getInputStream()));
        String hellogreeting = in.readLine();
            if ("Hello server".equals(hellogreeting)) {
                out.println("Hello Client");
            }
            else {
                out.println("Unknown greeting");
            }
    }
}
          </code></pre>
          </section> 

          <section data-transition="linear">
              <h3> Java TCP Sockets - client side</h3>

              <pre><code class="hljs java" style="font-size:70%; word-wrap: break-word;">
public class HalloClient {
    public void contactServer(String ip, int port) {
        clientSocket = new Socket(ip, port);
        PrintWriter out = new PrintWriter(clientSocket.getOutputStream(), true);
        BufferedReader in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));

        out.println("Hello server");
        String resp = in.readLine();
        System.out.println(resp);
}
              </code></pre>
          </section> 

          <section data-transition="linear">
              <h3>TCP Socket example in Java documentation </h3>

              <ul>
                  <li><a href="https://docs.oracle.com/javase/tutorial/networking/sockets/clientServer.html"
                         target="_blank">
                      KnockKnock game </a></li>
                  <li>3 classes:</li>
                  <ul>
                      <li>KnockKnockServer</li>
                      <li>KnockKnockClient</li>
                      <li>KnockKnockProtocol</li>
                  </ul>
              </ul>
          </section> 


          <section data-transition="linear">
              <h3> Java UDP Sockets </h3>
              <ul>
                  <li> <b>DatagramSocket</b> class</li>
                  <ul>
                      <li>constructor DatagramSocket(int port) throws SocketException</li>
                      <li>constructs datagram socket and binds it to the specified port on the local machine</li>
                      <li>java.net.SocketException indicates that socket could not be opened or couldn't be
                          bind to the specified local port</li>
                  </ul>
              </ul>
          </section> 

          <section data-transition="linear">
              <h3> Java UDP Sockets - Multicasting example </h3>
              <ul style="font-size:80%">
                  <li>Multicasting is the ability to have one device send a message
                   to more recepients</li>
                  <li>Idea is to use single ip address to send messages to many users</li>
                  <li>Multicasting is used in our example to send messages
                      to a group on a periodic basis</li>
                  <ul>

                      <li>example of a time server </li>
                      <li>server will send a date and time every second  </li>
                      <li>identical message is sent to all members of the group </li>
                      <li>server only broadcast messages,
                          it receives no messages from clients</li>
                      <li>command <span style="color:blue">Thread.sleep(1000)</span>
                          is used to make a break of 1 second </li>

                      <li>Why we use UDP and not TCP in this scenario? </li>
                  </ul>
              </ul>
          </section> 


          <section data-transition="linear">
              <h3> Java UDP Sockets - Multicasting server</h3>
              <pre class="stretch"><code class="hljs java" 
                         style="font-size:90%; line-height:1.3;  word-wrap: break-word;">
public class MulticastServer {
    public static void main(String[] args) {
        System.out.println("Multicast time server!"); 
        DatagramSocket serverSocket = null;
        try{
            serverSocket = new DatagramSocket();
            while(true){ 
              String dateText = new Date().toString(); 
              byte[] buffer = new byte[256];
              dateText.getBytes();
            
              InetAddress group = InetAddress.getByName("254.0.0.0"); 
              DatagramPacket packet = new DatagramPacket(buffer, buffer.length,
                                               group, 8888); 
              serverSocket.send(packet);
              System.out.println("Time sent: " + dateText);
        }catch(SocketException se){  
            se.printStackTrace();
        }catch(IOException e){  
            e.printStackTrace();
        }
}
              </code></pre>
          </section> 


          <section data-transition="linear">
              <h3> Java UDP Sockets - Multicasting client</h3>
              <ul>
                  <li>MulticastSocket bound to the specified socket address </li>
                  <li>to receive messages client must be joined to the group </li>
                  <li><span style="color:navy">InetAddress</span> is used to get the group </li>
                  <li>in the for loop client receives 5 packets, prints their content
                      and after the loop leaves the group </li>
              </ul>
          </section>


          <section data-transition="linear">
              <h3> Java UDP Sockets - Multicasting client cont.</h3>
              <pre class="stretch"><code class="hljs java" style="font-size:89%;
                                                line-height:1.3;  word-wrap: break-word;">
public class MulticastClient { 
   public static void main(String args[]) {
      System.out.println("Multicast  Time Client"); 
      try (MulticastSocket socket = new MulticastSocket(8888)) { 
        InetAddress group = InetAddress.getByName("224.0.0.0");
        socket.joinGroup(group); 
        System.out.println("Multicast  Group Joined");

        byte[] buffer = new byte[256]; 
        DatagramPacket packet = new DatagramPacket(buffer, buffer.length);

        for (int i = 0; i < 5; i++) { 
            socket.receive(packet); 
            String received = new String(packet.getData()); 
            System.out.println(received.trim()); 
        }
       socket.leaveGroup(group); 
     } catch (IOException ex) {
            // Handle exception
     } 
     System.out.println("Multicast  Time Client Terminated"); 
 } 
}
              </code></pre>
          </section> 

          <section data-transition="linear">
              <h3>HTTP - (HyperText Transfer Protocol) </h3>

              <ul style="font-size:75%">
                  <li>Probably the most widely used <b>application layer protocol</b> in the world today</li>
                  <li>used to deliver resources across <b>WWW</b></li>
                  <li>delivered resources are mostly <b>HTML</b> HyperTextMarkupLanguage files,
                  but also audio, video, etc...</li>
                  <li> users enter a <b>URL</b> address in a browser to obtain a resource </li>

              </ul>
              <img src="myfiles/images/communication/http-communication.svg" style="width:70%" />
          </section> 


          <section data-transition="linear">
              <h3>HTTP </h3>
              <ul style="font-size:70%">
                  <li>web browser has a role of client application and  web server
                      has a role of server which responds to client requests</li>
                  <li>default port used by servers is <b>80</b> (occasionally port 8080) </li>
                  <li>famous http servers </li>
                  <li>HTTP is <b>stateless protocol</b> - http server doesn't have to retain
                      information (status) of each user during multiple request </li>
                  <li> secure transfer is possible using <b>SSL</b> (Secure Sockets Layer) -
                      extension known as <b>HTTPS</b>
                  <li>well known http servers:</li>
                  <ul>
                      <li>Apache HTTP server - the most used</li>
                      <li>nginx</li>
                      <li>Microsoft IIS</li>
                      <li>Google Web server</li>
                      <li>Appache Tomcat</li>
                  </ul>
                  <li>versions: HTTP 1.0, HTTP/1.1, HTTP/2</li>
              </ul>
          </section> 

          <section data-transition="linear">
              <h3>HTTP messages </h3>
              <ul style="font-size:77%">
                  <li>two types of messages: <span style="color:blue">request</span> and <span style="color:blue">response</span> </li>
                  <li> request example</li>
                  <pre><code class="hljs txt" style="font-size:90%;
                                                    line-height:1.2;  word-wrap: break-word;">
GET /path/file.html HTTP/1.1
Host: www.example.com
                  </code></pre>
                  <li>request methods specify desired action: GET, HEAD, POST, PUT,
                      DELETE, OPTIONS, TRACE, OPTIONS, CONNECT, PATCH</li>
                  <li> response header (example of an initial line)</li>
                  <pre><code class="hljs txt" style="font-size:90%;
                                    line-height:1.2;  word-wrap: break-word;">
HTTP/1.0 404 Not Found
                  </code></pre>

                  <li>response initial line contains response code which
                      reflects the status of the result</li>
                  <li>after the header and an empty line we have the actual content of the message</li>
              </ul>
          </section> 
          <section data-transition="zoom">
              <h3>HTTP server response </h3>
              <ul style="font-size:80%">
                  <li>example from wikipedia</li>
              </ul>
                  <pre class="strech"><code class="hljs html" style="font-size:80%;
                                    line-height:1.2;  word-wrap: break-word;">
HTTP/1.1 200 OK
Date: Mon, 23 May 2005 22:38:34 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 138
Last-Modified: Wed, 08 Jan 2003 23:11:55 GMT
Server: Apache/1.3.3.7 (Unix) (Red-Hat/Linux)
ETag: "3f80f-1b6-3e1cb03b"
Accept-Ranges: bytes
Connection: close

&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;An Example Page&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;p&gt;Hello World, this is a very simple HTML document.&lt/p&gt;
    &lt;/body&gt;
<&lt;/html&gt;
                  </code></pre>
          </section> 




          <section data-transition="linear">
              <h3> Simple Web server implementation in Java</h3>
              <ul style="font-size:70%">
                  <li> server should support HTTP/1.0 protocol </li>
                  <li> server limited to handling only GET requests </li>
                  <li>example in the book
                      <a href="https://www.oreilly.com/library/view/learning-network-programming/9781785885471/"
                         target="_blank">
                          Learning Network Programming with Java </a></li>

              </ul>
         <pre class="stretch"><code class="hljs java" style="font-size:75%;
                                    line-height:1.3;  word-wrap: break-word;">
public class WebServer { 
   public WebServer() {
      System.out.println("Web server started"); 
      try (ServerSocket serverSocket = new ServerSocket(80)) { 
        while(true) { 
            System.out.println("Waiting for client request"); 
            socket.receive(packet); 

            Socket remote = serverSocket.accept(); 
            System.out.println("Connection made"); 
            new Thread( new ClientHandler(remote)).start() 
        }
     }catch (IOException ex) {
           ex.printStackTrace(); 
     } 
   }
   public static void main(String args[]) {
        new WebServer();
   }
}
              </code></pre>
          </section> 

          <section data-transition="linear">
              <h3> Web server - Client handler</h3>
         <pre class="stretch"><code class="hljs java" style="font-size:80%;
                                    line-height:1.3;  word-wrap: break-word;">
public class ClientHandler implements Runnable {

    private final Socket socket;

    public ClientHandler(Socket socket) {
        this.socket = socket;
    }

    @Override
    public void run() {
        System.out.println("\nClientHandler Started for " + 
            this.socket);
        handleRequest(this.socket);
        System.out.println("ClientHandler Terminated for " 
            + this.socket + "\n");
    }

}              </code></pre>
          </section> 

          <section data-transition="linear">
              <h3>Client which communicates with the Web server  </h3>

              <ul>
                  <li>ClientHandler have to implement Runnable
                            because it is used in the thread constructor argument </li>
              </ul>
         <pre class="stretch"><code class="hljs java" style="font-size:80%;
                                    line-height:1.3;  word-wrap: break-word;">
public class ClientHandler { 
   public static Socket socket;

   public static main(String[] args){
      System.out.println("Web server started"); 
      try (socket = new Socket(80)) { 
        while(true) { 
            System.out.println("Waiting for client request"); 
            socket.receive(packet); 

            Socket remote = serverSocket.accept(); 
            System.out.println("Connection made"); 
            new Thread( new ClientHandler(remote)).start() 
        }
     }catch (IOException ex) {
           ex.printStackTrace(); 
     } 
   }
}
              </code></pre>
          </section> 

          <section data-transition="linear">
              <h3><mark>RPC (Remote procedure calls)</mark></h3>
              <ul style="font-size:70%">
                  <li>Client-server communication discussed so far is message-based
                      and we didn't conceal sending and receiving messages</li>
                  <li>RPC is s way to achieve <b>access transparency</b></li>
                  <li>RPC provides a way to call a function on a remote server
                      using the same syntax as <em>if you call it in the local library</em></li>
                  <li>RPC is, for example, useful in the following situations:</li>
                  <ul>
                      <li>due to the size of the program there is a need
                          to spread it accross several machines</li>
                      <li>there is a need to  process information which is only available on a remote network </li>
                  </ul>
                  <li>when a process on machine A calls procedure(function) on B
                  it stops and wait while it's executed</li>
                  <li>no message passing should be visible to the programmer</li>
                  <li>remote procedure call should look as a local procedure call </li>
              </ul>
          </section> 

          <section data-markdown>
              <textarea data-template>
## RPC cont.
* What makes RPC different form message passing 
  (and other protocols such as HTTP and SMTP)
 * RPC is lacking strong sematics of the call 
  (it assigns no meaning to the data passed except supporting basic
data types)
 * RPC leaves it up to the developer to define which function calls will
a server support  

* common feature is to signal that exception occurred while running remote
 function (in such cases client could raise an exception)
              </textarea>
          </section>

          <section data-transition="linear">
              <h3>RPC implementation</h3>

              <ul style="font-size:70%">
                  <li>implementation issues</li>
                  <ul>
                      <li>calling and called procedure run on different machines
                          and in different address space</li>
                      <li>parameters and results also have to be passed</li>
                  </ul>
                  <li>RPC achieves transparency by offering <b>client stub</b>
                      to the calling client </li>
                  <ul>
                      <li> client stub has the same calling sequence as normal
                          procedure on the server side</li>
                      <li>client stub doesn't execute operation but just sends
                          messages to the server </li>
                  </ul>
                  <li> server has a <b>server stub</b> (often referred
                      to as a <b>skeleton</b>)  which is a server-side equivalent to the client stub</li>
                  <ul>
                      <li> server stub transforms requests comming from the
                          network into local procedure call</li>
                      <li> when local procedure is executed it packs results in a
                          message and calls send to return it to the client</li>
                  </ul>
              </ul>
          </section> 


          <section data-transition="linear">
              <h3>RPC - parameter passing</h3>

              <ul style="font-size:80%">
                  <li>client stub has a function to take parmeters, pack it in a message
                  and send it to the server stub</li>
                  <ul>
                      <li>packing parameters into a message is called
                          <b>parameter marshaling</b></li>
                  </ul>
                  <li>sever stub has to unpack the message and take sent parameters </li>
                  <ul>
                      <li>unpacking parameters from the message is called
                          <b>unmarshaling</b></li>
                  </ul>
                  <li> marshaling and unmarshaling should transform data into neutral formats</li>
                  <ul>
                      <li> transforation to neutral formats is necessary because different machines
                          can have differnt byte-ordering rules and other differences</li>
                      <li>Intel processors for instance use <b>little endian</b> (numbering bytes
                          form right to left) and older ARM processors use big-endian
                  </ul>
              </ul>
          </section> 


          <section data-transition="linear">
              <h3>RPC - parameter passing issues</h3>

              <ul style="font-size:80%">
                  <li>languages has mostly two types of parameter passing </li>
                  <ul>
                      <li> <b>copy-by-value </b></li>
                      <li> <b>copy-by-reference</b> </li>
                  </ul>
                  <li>copy-by-reference (using pointers) is specialy problematic for RPC</li>
                  <ul>
                      <li> when we copy-by-reference we basically copy the address
                          in our local address space and when we transfer it to
                          the server it's there useless</li>
                      <li>one part of a solution is to copy these parameters by value if they
                      would be only read on the server side</li>

                  </ul>
              </ul>
          </section> 

          <section data-transition="linear">
              <h3>RPC example in python</h3>
              <ul style="font-size:90%">
                  <li>example implemented on the local mashine</li>
                  <li>python has in-built server which can be run through the
                      script located in <b>bin/rpyc_classic.py</b> of
                      python installation:  <b>python bin/rpyc_classic.py</b></li>
                  <li> on the client side we have a simple program using rpyc library</li>
              <pre><code class="hljs python" style="font-size:100%;
                           line-height:1.3;  word-wrap: break-word;">
import rpyc

conn = rpyc.classic.connect('localhost')
conn.execute('print('Hello world");
              </code></pre>

              </ul>
          </section> 

          <section data-transition="linear">
              <h3>RPC - Example 2</h3>
              <ul style="font-size:90%">
                  <li>in this example client side opens a textfile and prints
                      lines using <b>print_line</b> function</li>
                  <li>client calls a procedure <b>line_count</b> which
                      is located on the server side</li>
                  <pre class="stretch"><code class="hljs python" style="font-size:100%;
                                    line-height:1.3;  word-wrap: break-word;">
import rpyc

def print_line(string):
    print("Line:", repr(string))

proxy = rpyc.connect('localhost', 18861, config={'allow_public_attrs': True})
file_obj = open('textfile.txt')
linecount = proxy.root.line_counter(file_obj, print_line)
print("Number of lines in the file is: ", linecount)
                  </code></pre>
              </ul>
          </section> 

          <section data-transition="linear">
              <h3>RPC - Example 2 - server side</h3>
              <ul style="font-size:90%">
                  <li>server side reads the file
                      and every time calls client side function to print a line </li>
                  <li>we can see that communications is done several times and this
                  requires intensive use of the network</li>
                  <pre class="stretch"><code class="hljs python" style="font-size:100%;
                                                    line-height:1.3;  word-wrap: break-word;">
import rpyc
from rpyc.utils.server import ThreadedServer

class MyService(rpyc.Service):
    def exposed_line_counter(self, f_object, function):
        for line_num, line in enumerate(f_object.readlines()):
            function(line)
        return line_num+1

t = ThreadedServer(MyService, port=18861)
t.start()
                  </code></pre>
              </ul>
          </section> 

           <section data-transition="linear">
              <h3>CORBA - Common Object Request Architecture</h3>
              <ul style="font-size:80%">
                  <li>RPC proved to be adequate solution for the develoment of
                      two-tier client server architectures</li>
                  <li>RPC cauldn't provide flexibility and functionality required
                      by in n-tier applications</li>
                  <li>Common Object Request Architecture (CORBA) is offered as a
                      solution by Object Management Group (OMG) </li>
                  <ul>
                      <li>CORBA is an architecture that specifies interoperability
                      between distributed objects on the network</li>
                      <li> it is an <b>object-oriented middleware paradigm</b> </li>
                      <li> primary feature is interoperability between various
                          programming languages</li>
                      <li>CORBA is based on RPC and extends RPC framework by
                          object-oriented mechanisms</li>
                  </ul>
                  </ul> 

              </ul>
          </section> 

         <section data-transition="linear">
              <h3> Object Request Broker (ORB)</h3>
              <ul style="font-size:80%">
                  <li>main part of CORBA is <b>Object Request Broker</b> (ORB)</li>
                  <ul>
                      <li>object residing in a client make remote requests using an
                          interface to the ORB running on the local machine</li>
                      <li>local ORB sends the request to the remote ORB
                          (which resides on the server) and sends back an object
                          reference to the requester</li>
                      <li>object residing on the client can now make a remote method
                          invocation of the remote object </li>
                      <li>ORB marshals arguments and sends invocation over the
                          network to the remote object's ORB</li>
                      <li>remote object's ORB calls the method locally and sends results
                          back to the client.</li>
                  </ul>
              </ul>
          </section> 

         <section data-transition="linear">
              <h3> Object Request Broker (ORB) cont.</h3>
              <ul style="font-size:80%">
                  <li>services that an object provides are expressed in a
                      special language - <b>Interface Definition Language (IDL)</b> </li>
              </ul>
              <img src="myfiles/images/communication/corba1.svg" style="width:70%" />
          </section> 

          <section data-transition="linear">
              <h3> CORBA cont.</h3>
              <ul style="font-size:80%">
                  <li>currently there are many languages supported by CORBA providers,
                  the majority of them with C++ and Java  and some
                      other with Smalltalk, Perl, Python, etc.</li>
                  <li>some CORBA products are</li>
                  <ul>
                      <li>
                      <b>Orbacus</b> - (Java and C++ ORB from Iona Technologies)
                      </li>
                      <li>
                          <b>WebSphere</b> - (application server with an ORB from IBM)
                      </li>
                  </ul>
                  <li>CORBA showed to have many shortcomings and limitations
                      when used in Web environments and is supersided by more
                      compliant technologies (web services) </li>
              </ul>
          </section> 

          <section data-transition="linear">
              <h3><mark>Web services</mark></h3>
              <ul style="font-size:75%">
                  <li>historical overview of Web applications roughly looks as fallows:</li>
                  <ul>
                      <li><b>static web pages</b> - static HTML pages represented in
                          browsers </li>
                      <li><b>dinamic web pages</b> - interactions supported by Thread-based Server-technologies</li>
                      <ul>
                          <li>Java Servlets</li>
                          <li>Java Server Pages (JSP)</li>

                          <li>Hypertext Preprocessor (PHP)</li>
                          <li>ASP.NET</li>
                      </ul>
                      <img src="myfiles/images/communication/man-machine.svg" style="width:60%" />
                    <li>these technologies facilitated <b>man-to-machine</b> communication</li> 
                  </ul>

              </ul>
          </section> 

          <section data-transition="linear">
              <h3>Web services</h3>
              <ul style="font-size:80%">
                  <li>historicaly next step was to standardize <b>machine-to-machine</b>
                      communication on the Web </li>
                  <li>here <b>Web services</b> come into play</li>
                  <img src="myfiles/images/communication/machine-machine.svg" style="width:80%" />
              </ul>
          </section> 



          <section data-transition="linear">
              <h3>Web services</h3>
              <ul style="font-size:80%">
                  <li><b>web service</b> is a distributed application whose components
                      are executed on distinct devices </li>
                  <li>web services provide a <b>common communication platform</b> for
                      applications built in <b>various programming languages</b> </li>
                  <ul>
                      <li><b>language transparency</b> is the key to web service
                          <b>interoperability</b></li>
                      <li>interoperabilty represents an ability of <em>web services</em> and <em>requesters</em>
                          to interact seamlessly despite of differences in programming
                          languages, platforms and supporting libraries</li>
                      <li>language transparency is achieved by exchanging data
                          using <b>XML</b> technologies </li>
                      <li>XML supports structured document interchange and processing</li>

                  </ul>

              </ul>
          </section> 



          <section data-transition="linear">
              <h3>Web services cont.</h3>
              <ul style="font-size:80%">
                  <li>Web services are tipically <b>based on HTTP protocol</b></li>
                  <li>client can make requests for various web services (servers can
                     also behave as clients to some other servers)
                  </li>
                  <li>Web service features</li>
                  <ul>
                      <li><b>loosely coupled</b> - each service exists independently of
                      other services that make up application</li>
                      <li><b>easier integration</b> - providing easier communication between 
                      organizations </li>
                      <li><b>service reuse</b> - combining services to make a new functionality </li>
                  </ul>
                  <li>Web services can be "roughtly" devided  into two categries:</li>
                  <ul>
                    <li><b>SOAP</b> based</li> 
                    <li><b>REST</b> style</li> 
                  </ul>
              </ul>
          </section> 

          <section data-transition="linear">
              <h3>SOAP (Simple Object Access Protocol)</h3>
              <p>SOAP is an industry accepted W3C specification for ubiquitous
                  XML distributed computing infrastructure</p>

              <ul>
                  <li>transport-independent messaging protocol</li>
                  <li> mechanism for defining the unit of communication</li>
                  <li> mechanism for error handling</li>
                  <li>messages are <b>XML</b> documents which follow a specific pattern</li>
                  <ul>
                      <li>root element is known as Envelope element</li>
                      <li>header contains rooting data</li>
                      <li>body contains the actual message</li>
                  </ul>
              </ul>
          </section> 

          <section data-transition="linear">
              <h3>XML (eXtensible Markup Language)</h3>
              <p>It's a markup language similar to HTML which is designed to
              store and transport data</p>
              <ul style="font-size:80%">
                  <li>XML tags are not predefined as HTML tags</li>
                  <li>XML doesn't carry information how data should be presented</li>
                  <li>XML is hardware-independent and that's why it's used
                  for web services</li>
                  <li>each tag has it's cooresponding ending tag</li>
                  <pre class="stretch"><code class="hljs xml" style="font-size:80%;
                                                    line-height:1.3;  word-wrap: break-word;">
<?xml version="1.0"?>
&lt;message&gt;
  <sender>Alice</sender>
  <receiver>Bob</receiver>
  <message-body>  
      This is the place for the message body.
  </message-body>
&lt;/message&gt;
                  </code></pre>
              </ul>
          </section> 

          <section data-transition="linear">
              <h3>SOAP message format</h3>
              <pre class="stretch"><code class="hljs xml" style="font-size:100%;
                                                line-height:1.3;  word-wrap: break-word;">
<?xml version="1.0"?>
&lt;soap:Envelope
    xmlns:soap="http://www.w3.org/2003/05/soap-envelope/"  
    soap:encodingStyle="http://www.w3.org/2003/05/soap-encoding"&gt;

    <soap:Header>
        ...
    </soap:Header>

    <soap:Body>
        ...
        <soap:Fault>
            ...
        </soap:Fault>
    </soap:Body>

</soap:Envelope> 
              
              </code></pre>
          </section> 

          <section data-transition="linear">
              <h3>Simplified architecture of SOAP message transmission</h3>
              <img src="myfiles/images/communication/soap-based.svg" style="width:90%" />
          </section> 



          <section data-transition="linear">
              <h3>WSDL - (Web Service Description Language)</h3>
              <p> web services have to be described in order to clients know
                  what they offer (what they do)</p>

              <ul style="font-size:80%">
                  <li>WSDL file is a description of what the web service does</li>

                 <li>WSDL file is an XML format for describing all the information
                 needed to invoke and communicate with a Web service</li>
                 <li>WSDL contains:</li>
                 <ul>
                     <li><b>Functional description</b> - detail on how the Web
                         service is invoked, and focuses on details of syntax of the message and how to
                         configure protocols to deliver message</li>
                     <li><b>nonfunctional description</b> - details secondary for the
                         message such as security policy and additionaly instructions
                 </ul>
                  
                 <li>WSDL is automatically generated </li>
                 <ul>
              </ul>
          </section> 

          <section data-transition="linear">
              <h3>UDDI - (Universal Description, Discovery and Integration)</h3>
              <ul style="font-size:80%">
                  <ul>
                      When Web services are made they have to be publish and Web consumers need
                      some means to search and find them
                      <li><b>UDDI</b> is an XML-based registry of Web services</li>
                      <ul>
                          <li>UDDI search mechanism can focus on different criteria - business name,
                          business category, location, URL, etc. </li>
                          <li> UDDI can be interogated using SOAP messages and should
                          provide access to WSDL documents of services which are in it's
                          directory</li> 
                          <li>UDDI registries are commonly found in companies where
                          facilitate easer access to services</li>
                      </ul>  
              </ul>
          </section> 


          <section data-transition="linear">
              <h3>SOAP web services - properties</h3>

              <ul>
                  <li>SOAP web services become a well defined middleware
                      technology for the Internet</li>
                  <li> the use of HTTP made them usable besides Internet</li>
                  <li>they become open standards implemented by all main
                      programming languages   </li>

                  <li>SOAP web services have been over-engineered </li>
                  <li>Additional burden that XML based SOAP messages put on
                      network communication</li>

                 <li>this complexity of SOAP explains the current popularity of RESTful approaches</li>
              </ul>
          </section>


          <section data-transition="linear">
              <h3><mark>RESTful Web Services</mark></h3>
              <ul style="font-size:80%">
                  <li>Representational State Transfer (REST) </li>
                  <li>SOAP is messaging protocol while REST is a style of software
                  architecture </li>
                  <li>REST is an architecture for distributed systems (in which text,
                      video, graphics and other media are stored across a network and
                  connected through hyperlinks</li>
                 <li>evertything that has an URI is a <b>resource</b></li> 
                 <li>RESTful approach is to use HTTP as an API not just as a
                     transport protocol(in SOAP web services)</li>
                 <li>HTTP has its own methods that are suitable for CRUD operations </li>
                 <li>RESTful uses HTTP methods as onwn verbs </li>
                  <ul>
                      <li>GET - Reads an existing resource</li>
                      <li>POST - Creates a new resource </li>
                      <li>PUT - Updates an existing resource </li>
                      <li>DELETE - Deletes an existing resource </li>
                  </ul>
              </ul>
          </section> 

          <section data-transition="linear">
              <h3>REST features</h3>
              <ul style="font-size:80%">
                  <li>REST messages are more simple than SOAP messages</li>
                  <li>GET and DELETE verbs are used in requests that don't have a body</li>                   
                  <li>GET request, for instance, have no body and
                      query arguments are contained in the query string</li>
                  <ul>
                      <li>http://www.students-database.com/students?average-mark<3&studycourse=WISC17</li>
                      <li>question mark(?) begins the query string and
                          attributes which are key-value pairs are separated by ampersand(&)</li>
                  </ul>
                  <li>POST request has a body but that body can contain arbitrary
                      XML document (instead of SOAP envelope in SOAP web services)</li>
              </ul>
          </section> 



          <section data-transition="linear">
              <h3>RESTful web services in Java</h3>
              <ul style="font-size:80%">
                  <li><b>JAX-RS</b> (Java API for RESTful Web Services)  is a specification used in Java to
                      implement RESTful applications</li>
                  <li> JAX-RS is an API specification with it's specific annotations</li>
                  <li>JAX-RS has serveral implementations such as
                      <a href="https://jersey.github.io/">Jersey</a>,
                      <a href="https://resteasy.github.io/">RESTEasy</a>
                       
                      <a href="https://cxf.apache.org/">Apache CXF</a>
                  </li>
                  <li> <a href="https://spring.io/projects/spring-framework">Spring framework</a>
                      on the other hand provides an alternative implemetation of  RESTful applications
                  which doesn't comply to JAX-RS standard </li>
                  <a href="https://cxf.apache.org/">Apache CXF</a>
                  
              </ul>
          </section> 

          <section data-transition="linear">
              <h3> Additional literature used for these slides </h3>

              <ul style="font-size:90%">
                  <li>
                      <a href="https://www.oreilly.com/library/view/learning-network-programming/9781785885471/"
                         target="_blank">
                          Learning Network Programming with Java </a>, Richard M Reese, Packt Publishing, ISBN: 9781785885471</li>
                  <li>
                      <a href="https://pdfs.semanticscholar.org/18f2/8c21f0b94d072c9727f670357b26a43ff735.pdf"
                         target="_blank"> Computer networks UDP and TCP</a></li>
                  <li>
                      <a href="https://www.apress.com/gp/book/9781430258544"
                         target="_blank">
                          Foundations of Python Network Programming </a>, Brandon Rhodes,  John Goerzen</li>

                 <li>
                     <a href="https://www.tutorialspoint.com/python/python_rpc_json_server.htm"
                         target="_blank">
                          Tutorials point </a></li>
                 <a href="https://www.researchgate.net/publication/236860265_Introduction_to_Web_Services"
                    target="_blank">
                     Introduction to Web services </a>, Jorge Cardoso, John A. Miller</li>



              </ul>
          </section> 


          <section style="font-size: 1.2em;">
              <h2 style="padding-bottom: 25px;">Thank you!</h2>
              <h3 style="padding-bottom: 25px;"><a href="index.html#/content">Back to Table of Contents</a></h3>
          </section> 

			</div>
		</div>

		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true },
  				{ src: 'plugin/math/math.js', async: true }
				],
          // Add the current slide number to the URL hash so that reloading the
	        // page/copying the URL will return you to the same slide
	        hash: false,
				  controls: true,
				  progress: true,
				  history: true,
          touch:true, 
				  slideNumber: true,

	        // The "normal" size of the presentation, aspect ratio will be preserved
	        // when the presentation is scaled to fit different resolutions. Can be
	        // specified using percentage units.
	        width: 960,
	        height: 700,

			});
		</script>
	</body>
</html>
